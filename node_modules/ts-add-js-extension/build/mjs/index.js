import ParseArgs from "./cli-command-parser.js";
import { parseConfig, normaliseConfig } from "./config.js";
import { writeMany, findMany } from "./read-write.js";
const tsAddJsExtension = async (props) => {
    // eslint-disable-next-line @typescript-eslint/no-deprecated
    if (props.parsedConfigFunction) {
        throw new Error([
            `Please do not use parsedConfigFunction as it's deprecated and contains complicated parsing`,
            `Instead, just pass configurations directly`,
        ].join("\n"));
    }
    const normalisedConfig = normaliseConfig(props.config);
    return writeMany({
        showProgress: normalisedConfig.showProgress,
        foundMany: await findMany(normalisedConfig),
    });
};
const main = (args) => {
    const parser = ParseArgs.create(args);
    const help = parser.asHelp();
    if (help.exists) {
        return console.log(help.value);
    }
    const version = parser.asVersion();
    if (version.exists) {
        return console.log(version.value);
    }
    return tsAddJsExtension({
        config: parser.asOperation(),
    })
        .then((result) => {
        switch (result.type) {
            case "error": {
                console.error(result.error);
            }
        }
    })
        .catch((error) => {
        console.error(error);
    });
};
export { parseConfig, tsAddJsExtension };
export default main;
//# sourceMappingURL=index.js.map
